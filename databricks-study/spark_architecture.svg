<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1200" height="800" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">Apache Spark Architecture with Storage</text>
  
  <!-- Cluster Manager Section -->
  <rect x="50" y="60" width="300" height="80" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="10"/>
  <text x="200" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Cluster Manager</text>
  <text x="200" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">YARN / Kubernetes / Mesos / Standalone</text>
  <text x="200" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Resource Allocation & Scheduling</text>
  
  <!-- Driver Program Section -->
  <rect x="450" y="60" width="300" height="120" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="10"/>
  <text x="600" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Driver Program</text>
  <text x="600" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">SparkSession / SparkContext</text>
  <text x="600" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">DAG Scheduler</text>
  <text x="600" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Task Scheduler</text>
  <text x="600" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Block Manager Master</text>
  
  <!-- Spark UI -->
  <rect x="850" y="60" width="200" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="10"/>
  <text x="950" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Spark UI</text>
  <text x="950" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">Monitoring & Debugging</text>
  
  <!-- Worker Nodes Section -->
  <g id="worker-nodes">
    <!-- Worker Node 1 -->
    <rect x="50" y="220" width="280" height="200" fill="#27ae60" stroke="#229954" stroke-width="2" rx="10"/>
    <text x="190" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">Worker Node 1</text>
    
    <!-- Executor 1 -->
    <rect x="70" y="260" width="120" height="140" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="130" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Executor</text>
    <text x="130" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">JVM Process</text>
    
    <!-- Tasks in Executor 1 -->
    <rect x="80" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="100" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 1</text>
    <rect x="130" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="150" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 2</text>
    
    <!-- Cache/Memory -->
    <rect x="80" y="345" width="100" height="20" fill="#34495e" stroke="#2c3e50" stroke-width="1" rx="3"/>
    <text x="130" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Cache/Memory</text>
    
    <!-- Block Manager 1 -->
    <rect x="80" y="370" width="100" height="20" fill="#16a085" stroke="#138d75" stroke-width="1" rx="3"/>
    <text x="130" y="383" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Block Manager</text>
    
    <!-- Executor 2 -->
    <rect x="200" y="260" width="120" height="140" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="260" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Executor</text>
    <text x="260" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">JVM Process</text>
    
    <!-- Tasks in Executor 2 -->
    <rect x="210" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="230" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 3</text>
    <rect x="260" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="280" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 4</text>
    
    <!-- Cache/Memory -->
    <rect x="210" y="345" width="100" height="20" fill="#34495e" stroke="#2c3e50" stroke-width="1" rx="3"/>
    <text x="260" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Cache/Memory</text>
    
    <!-- Block Manager 2 -->
    <rect x="210" y="370" width="100" height="20" fill="#16a085" stroke="#138d75" stroke-width="1" rx="3"/>
    <text x="260" y="383" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Block Manager</text>
    
    <!-- Worker Node 2 -->
    <rect x="370" y="220" width="280" height="200" fill="#27ae60" stroke="#229954" stroke-width="2" rx="10"/>
    <text x="510" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">Worker Node 2</text>
    
    <!-- Executor 3 -->
    <rect x="390" y="260" width="120" height="140" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="450" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Executor</text>
    <text x="450" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">JVM Process</text>
    
    <!-- Tasks in Executor 3 -->
    <rect x="400" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="420" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 5</text>
    <rect x="450" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="470" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 6</text>
    
    <!-- Cache/Memory -->
    <rect x="400" y="345" width="100" height="20" fill="#34495e" stroke="#2c3e50" stroke-width="1" rx="3"/>
    <text x="450" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Cache/Memory</text>
    
    <!-- Block Manager 3 -->
    <rect x="400" y="370" width="100" height="20" fill="#16a085" stroke="#138d75" stroke-width="1" rx="3"/>
    <text x="450" y="383" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Block Manager</text>
    
    <!-- Executor 4 -->
    <rect x="520" y="260" width="120" height="140" fill="#2ecc71" stroke="#27ae60" stroke-width="2" rx="5"/>
    <text x="580" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Executor</text>
    <text x="580" y="300" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">JVM Process</text>
    
    <!-- Tasks in Executor 4 -->
    <rect x="530" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="550" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 7</text>
    <rect x="580" y="310" width="40" height="25" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
    <text x="600" y="326" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Task 8</text>
    
    <!-- Cache/Memory -->
    <rect x="530" y="345" width="100" height="20" fill="#34495e" stroke="#2c3e50" stroke-width="1" rx="3"/>
    <text x="580" y="358" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Cache/Memory</text>
    
    <!-- Block Manager 4 -->
    <rect x="530" y="370" width="100" height="20" fill="#16a085" stroke="#138d75" stroke-width="1" rx="3"/>
    <text x="580" y="383" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Block Manager</text>
  </g>
  
  <!-- Storage Systems Section -->
  <rect x="50" y="480" width="600" height="120" fill="#8e44ad" stroke="#7d3c98" stroke-width="2" rx="10"/>
  <text x="350" y="505" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">Storage Systems</text>
  
  <!-- HDFS -->
  <rect x="70" y="520" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="120" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">HDFS</text>
  <text x="120" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Distributed</text>
  <text x="120" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">File System</text>
  
  <!-- Amazon S3 -->
  <rect x="190" y="520" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="240" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Amazon S3</text>
  <text x="240" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Object</text>
  <text x="240" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Storage</text>
  
  <!-- Databases -->
  <rect x="310" y="520" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="360" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Databases</text>
  <text x="360" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">MySQL, Postgres</text>
  <text x="360" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">MongoDB, etc.</text>
  
  <!-- Kafka -->
  <rect x="430" y="520" width="100" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="480" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Kafka</text>
  <text x="480" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Streaming</text>
  <text x="480" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Data</text>
  
  <!-- Local FS -->
  <rect x="550" y="520" width="80" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="590" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Local FS</text>
  <text x="590" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">File</text>
  <text x="590" y="570" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">System</text>
  
  <!-- Data Flow Section -->
  <rect x="700" y="220" width="450" height="260" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="10"/>
  <text x="925" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">Data Flow & Components</text>
  
  <!-- RDD -->
  <rect x="720" y="260" width="80" height="40" fill="#e67e22" stroke="#d35400" stroke-width="2" rx="5"/>
  <text x="760" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">RDD</text>
  <text x="760" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Low Level)</text>
  
  <!-- DataFrame -->
  <rect x="820" y="260" width="80" height="40" fill="#3498db" stroke="#2980b9" stroke-width="2" rx="5"/>
  <text x="860" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">DataFrame</text>
  <text x="860" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Structured)</text>
  
  <!-- Dataset -->
  <rect x="920" y="260" width="80" height="40" fill="#27ae60" stroke="#229954" stroke-width="2" rx="5"/>
  <text x="960" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Dataset</text>
  <text x="960" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Type Safe)</text>
  
  <!-- Spark SQL -->
  <rect x="1020" y="260" width="80" height="40" fill="#9b59b6" stroke="#8e44ad" stroke-width="2" rx="5"/>
  <text x="1060" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Spark SQL</text>
  <text x="1060" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(SQL Interface)</text>
  
  <!-- Catalyst Optimizer -->
  <rect x="770" y="320" width="150" height="40" fill="#f39c12" stroke="#e67e22" stroke-width="2" rx="5"/>
  <text x="845" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Catalyst Optimizer</text>
  <text x="845" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Query Optimization)</text>
  
  <!-- Tungsten -->
  <rect x="950" y="320" width="150" height="40" fill="#e74c3c" stroke="#c0392b" stroke-width="2" rx="5"/>
  <text x="1025" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Tungsten</text>
  <text x="1025" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(Memory Management)</text>
  
  <!-- Spark Modules -->
  <rect x="720" y="380" width="100" height="40" fill="#16a085" stroke="#138d75" stroke-width="2" rx="5"/>
  <text x="770" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Spark Core</text>
  <text x="770" y="415" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(RDD API)</text>
  
  <rect x="840" y="380" width="100" height="40" fill="#16a085" stroke="#138d75" stroke-width="2" rx="5"/>
  <text x="890" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Spark SQL</text>
  <text x="890" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">DataFrames</text>
  <text x="890" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">(Structured Data)</text>
  
  <rect x="960" y="380" width="80" height="40" fill="#16a085" stroke="#138d75" stroke-width="2" rx="5"/>
  <text x="1000" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Spark</text>
  <text x="1000" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Streaming</text>
  <text x="1000" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">(Real-time)</text>
  
  <rect x="1060" y="380" width="80" height="40" fill="#16a085" stroke="#138d75" stroke-width="2" rx="5"/>
  <text x="1100" y="400" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">MLlib</text>
  <text x="1100" y="415" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">(ML Library)</text>
  
  <!-- Memory Tiers -->
  <rect x="700" y="500" width="450" height="80" fill="#34495e" stroke="#2c3e50" stroke-width="2" rx="10"/>
  <text x="925" y="520" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Memory Management Tiers</text>
  
  <rect x="720" y="535" width="90" height="30" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3"/>
  <text x="765" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Execution</text>
  
  <rect x="820" y="535" width="90" height="30" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3"/>
  <text x="865" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Storage</text>
  
  <rect x="920" y="535" width="90" height="30" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3"/>
  <text x="965" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">User Memory</text>
  
  <rect x="1020" y="535" width="90" height="30" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="3"/>
  <text x="1065" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Reserved</text>
  
  <!-- Arrows showing data flow -->
  <!-- Driver to Executors -->
  <path d="M 600 180 L 190 220" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 600 180 L 510 220" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Executors to Storage -->
  <path d="M 190 420 L 190 480" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 350 420 L 350 480" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 510 420 L 510 480" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Cluster Manager to Driver -->
  <path d="M 350 100 L 450 100" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Driver to Spark UI -->
  <path d="M 750 90 L 850 90" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <rect x="50" y="650" width="1100" height="120" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="10"/>
  <text x="600" y="675" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">Key Components Explained</text>
  
  <text x="70" y="700" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Driver Program:</text>
  <text x="200" y="700" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Contains SparkSession, coordinates execution, converts user code to tasks</text>
  
  <text x="70" y="720" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Executors:</text>
  <text x="200" y="720" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">JVM processes that run tasks, cache data, and report results back to driver</text>
  
  <text x="70" y="740" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Block Manager:</text>
  <text x="200" y="740" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Manages memory and disk storage for cached data and intermediate results</text>
  
  <text x="620" y="700" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Cluster Manager:</text>
  <text x="750" y="700" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Manages resources across the cluster (CPU, memory allocation)</text>
  
  <text x="620" y="720" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Storage Systems:</text>
  <text x="750" y="720" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">External data sources that Spark can read from and write to</text>
  
  <text x="620" y="740" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">• Catalyst Optimizer:</text>
  <text x="750" y="740" font-family="Arial, sans-serif" font-size="11" fill="#2c3e50">Optimizes DataFrame/SQL queries for better performance</text>
</svg>